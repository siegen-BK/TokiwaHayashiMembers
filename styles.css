:root{
  /* 完全黒/白のみを使用 */
  --ink:#000;           /* 文字色（黒） */
  --grid:#000;          /* 罫線色（黒） */
  --bg:#fff;            /* 背景（白） */
  --muted:#000;         /* ここも黒に揃える */

  /* 列幅（先頭行/追加行で共通） */
  --col-section: 1.6fr; /* 区間・場所 */
  --col-part:    0.92fr;/* 大胴〜笛（均等） */
  --col-notes:   1.4fr; /* 備考 */

  /* 行の高さ（2段構成の基準） */
  --h-unit: 36px;                     /* 1段の高さ */
  --header-h: calc(var(--h-unit) / 2);/* 先頭行は半分の高さ */

  /* sticky の top（JSから代入） */
  --sticky-top-toolbar:   0px;  /* タブ直下にツールバー */
  --sticky-top-tablehead: 0px;  /* ツールバー直下に先頭行 */
}

*{ box-sizing:border-box; }

body{
  font-family: system-ui, -apple-system, "Segoe UI", Roboto, Helvetica, Arial;
  margin:0;
  color:var(--ink);
  background:var(--bg);
}

/* =========================
   ① タブ（アプリヘッダ）最上段に固定
   ========================= */
.app-header{
  position: sticky;
  top: 0;
  z-index: 100;            /* 最前面（下の帯を覆う） */
  background:#fff;         /* 透け防止：白で塗る */
  border-bottom:1px solid #000; /* 黒の1px */
  padding:12px 16px;
}
.tabs{
  display:flex;
  gap:8px;
  align-items:center;
  margin-top:8px;
  flex-wrap:wrap;
}
.tab{
  padding:6px 10px;
  border:1px solid #000;      /* 枠も黒 */
  border-radius:8px;
  text-decoration:none;
  color:#000;                  /* 文字黒 */
  background:#fff;
}
.tab.active{
  /* タブの配色を黒/白で表現（必要なら後で青に戻せます） */
  background:#000;
  color:#fff;
  border-color:#000;
}
.print{ margin-left:auto; }

main{
  padding:16px;
  max-width:960px;
  margin:0 auto;
}

/* =========================
   ② タイトル＆書式ボタン（タブ直下に固定）
   ========================= */
.section-toolbar{
  position: sticky;
  top: var(--sticky-top-toolbar);
  z-index: 90;
  background:#fff; /* 透け防止：白で全面塗る */
  /* 下枠線は引かない（二重線化の原因になるため） */
  border-bottom:none;

  /* 左右の余白エリアまで白で覆って、下のボタンを隠す */
  box-shadow:
    100vmax 0 0 0 #fff,  /* 右側を白で広く覆う */
    -100vmax 0 0 0 #fff; /* 左側を白で広く覆う */

  max-width:960px;
  margin:0 auto;
  min-height:44px;
}
.toolbar-left{
  position:absolute;
  left:0;
  top:50%;
  transform:translateY(-50%);
  display:flex;
  gap:8px;
  align-items:center;
}
.align-inline button,
.btn-add{
  padding:6px 10px;
  border:1px solid #000;   /* 黒の1px */
  background:#fff;
  color:#000;
  border-radius:8px;
  cursor:pointer;
}
.align-inline button:hover,
.btn-add:hover{
  background:#fff;         /* 黒白のみ：色変化なし */
}

/* 表の幅に対し中央 */
.sheet-title{
  margin:8px 0;
  text-align:center;
  font-size:28px;
  font-weight:700;
  color:#000;
}

/* =========================
   Excel風：外枠＋格子
   ========================= */

/* 列定義（ヘッダ/行で共通） */
.first-row-table,
.row-group{
  grid-template-columns:
    var(--col-section)
    var(--col-part) var(--col-part) var(--col-part)
    var(--col-part) var(--col-part)
    var(--col-notes);
}

/* =========================
   ③ 先頭行（表ヘッダ）：ツールバー直下に固定
   ========================= */
.first-row-table{
  display:grid;

  /* 外枠：上/左/右とも黒の1px（下はデータ側に任せる） */
  border-top:1px solid #000;   /* ← 純黒の1px。太線原因の“前段の線”は無しにしている */
  border-left:1px solid #000;
  border-right:1px solid #000;
  border-bottom:none;

  margin:0;
  column-gap:0;
  row-gap:0;

  position: sticky;
  top: var(--sticky-top-tablehead);
  z-index: 80;
  background:#fff;

  /* ヘッダの左右の外側（ボタン走行レーン）も白で覆って隠す */
  box-shadow:
    100vmax 0 0 0 #fff,    /* 右側の覆い */
    -100vmax 0 0 0 #fff;   /* 左側の覆い */
}

/* ヘッダセル：下線は全セル、縦線は“最後以外” */
.first-row-table .cell{
  border-bottom:1px solid #000;
  padding:0 12px;
  min-height:var(--header-h);
  display:flex;
  align-items:center;
  justify-content:center;
  text-align:center;
  font-size:15px;
  color:#000;
  background:#fff;
  white-space:nowrap;
}
.first-row-table .cell:not(:last-child){
  border-right:1px solid #000;
}

/* ---- データ行群（スクロールで動くのはここだけ） ---- */
.rows{
  position:relative;   /* スタッキング文脈：下層 */
  z-index: 1;
  border-left:1px solid #000;
  border-right:1px solid #000;
  margin-top:0;
}

/* 1行＝2段グリッド */
.row-group{
  display:grid;
  grid-template-rows: 1fr 1fr;
  border-bottom:1px solid #000;
  position:relative;               /* 右外側ボタンの基準 */
  column-gap:0;
  row-gap:0;
}

/* セル共通 */
.row-group .cell{
  border-right:1px solid #000;
  padding:10px 12px;
  font-size:15px;
  color:#000;
  background:#fff;
  display:flex;
  flex-direction:column;
  align-items:stretch;
  justify-content:center;
  min-height:var(--h-unit);
}

/* 右端セル（備考）は右線なし → 外枠に任せる */
.row-group .cell:last-of-type{
  border-right:none;
}

/* 2段ぶち抜き（大胴・中胴・側胴・備考） */
.row-group .span2{
  grid-row: 1 / span 2;
  min-height: calc(var(--h-unit) * 2);
}

/* 鉦・笛：下段に仕切り線 */
.cell.split-top{
  border-top:1px solid #000;
}

/* =========================
   右外側：ツール／削除（行の垂直中央）
   ========================= */
.row-tools,
.row-del{
  position:absolute;
  top:50%;
  transform:translateY(-50%);
  width:34px;
  height:34px;
  border:1px solid #000;   /* 黒の1px */
  border-radius:8px;
  background:#fff;
  color:#000;
  cursor:pointer;
  display:grid;
  place-items:center;
  font-size:16px;
  line-height:1;
  z-index:5;               /* ← 固定帯(z=80/90/100)の下に必ず隠れる */
}
.row-tools{ right:-44px; }
.row-del  { right:-84px; }

/* ホバー変化は色無し（黒白固定） */
.row-tools:hover,
.row-del:hover{
  background:#fff;
}

/* =========================
   行間境界スワップ（⇅）
   ========================= */
.swap-slot{
  position:relative;
  height:0;
}
.swap-slot .row-swap{
  position:absolute;
  left:-44px;
  top:-17px;           /* 34px の半分だけ上へ */
  width:34px; height:34px;
  border:1px solid #000;
  border-radius:8px;
  background:#fff;
  color:#000;
  cursor:pointer;
  display:grid; place-items:center;
  font-size:16px; line-height:1;
  z-index:5;          /* ← 固定帯より確実に下 */
}

/* 画面が狭いときは内側へ（ボタン位置調整） */
@media (max-width: 520px){
  .row-tools{ right:6px; }
  .row-del  { right:46px; }
  .swap-slot .row-swap{ left:6px; }
}

/* 印刷（黒線維持） */
@media print{
  :root{ --grid:#000; --ink:#000; }
  .app-header{ position:static; }
  .section-toolbar{ position:static; box-shadow:none; }
  .first-row-table{ position:static; }
  main{ max-width:none; margin:0; padding:0 18mm; }
}
