:root{
  --ink:#000;        
  --grid:#000;       
  --bg:#fff;         

  --col-section: 1.6fr;  
  --col-part:    0.92fr; 
  --col-notes:   1.4fr;  

  --h-unit: 36px;                      
  --header-h: calc(var(--h-unit) / 2); 

  --sticky-top-toolbar:   0px;  
  --sticky-top-tablehead: 0px;  
  --toolbar-h: 44px;            
}

*{ box-sizing:border-box; }

body{
  font-family: system-ui, -apple-system, "Segoe UI", Roboto, Helvetica, Arial;
  margin:0;
  color:var(--ink);
  background:var(--bg);
}

/* =========================================================
   固定帯 1: ヘッダー全幅
   ========================================================= */
.app-header{
  position: fixed;
  top: 0;
  left:0;
  right:0;
  width: 100vw;       
  z-index: 100;
  background:#fff;
  border-bottom: 1px solid #000;
  padding: 12px 16px;
  display: flex;
  flex-direction: column;
  align-items: center;
}

/* タイトルとボタン配置 */
.section-toolbar{
  position: fixed;
  top: 60px;
  z-index: 90;
  width: 100%;           /* 全幅 */
  min-height:44px;
  background:#fff;
  border-bottom: none;
  display: flex;
  align-items: center;
  justify-content: center;  /* タイトル中央 */
  padding: 0 98px;          /* 左右余白確保 */
}

.toolbar-left{
  position: absolute;
  left:0;
  display:flex;
  gap:8px;
  align-items:center;
}

/* ボタンデザイン */
.align-inline button,
.btn-add{
  padding:6px 10px;
  border:1px solid #000;
  border-radius:8px;
  background:#fff;
  color:#000;
  cursor:pointer;
}

.align-inline button:hover,
.btn-add:hover{
  background:#fff; 
}

/* タイトル中央 */
.sheet-title{
  font-size:28px;
  font-weight:700;
  color:#000;
  text-align:center;
  margin:0;
}

/* =========================================================
   表（Excel風）
   ========================================================= */
.first-row-table,
.row-group{
  display:grid;
  grid-template-columns:
    var(--col-section)
    var(--col-part) var(--col-part) var(--col-part)
    var(--col-part) var(--col-part)
    var(--col-notes);
}

.first-row-table{
  border-top: 1px solid #000;
  border-left: 1px solid #000;
  border-right: 1px solid #000;
  border-bottom: none;
  margin:0;
  column-gap:0;
  row-gap:0;

  position: fixed;
  top: 104px;
  z-index: 80;
  background:#fff;

  max-width: calc(100% - 196px); 
  left: 50%;
  transform: translateX(-50%);
}

.first-row-table .cell{
  border-bottom: 1px solid #000;
  padding: 0 12px;
  min-height: var(--header-h);
  display:flex;
  align-items:center;
  justify-content:center;
  text-align:center;
  font-size:15px;
  color:#000;
  background:#fff;
  white-space:nowrap;
}

.first-row-table .cell:not(:last-child){
  border-right: 1px solid #000;
}

/* =========================================================
   データ行
   ========================================================= */
.rows{
  position:relative;
  z-index:1;
  border-left: 1px solid #000;
  border-right: 1px solid #000;
  margin-top:0;

  max-width: calc(100% - 196px); 
  left: 50%;
  transform: translateX(-50%);
}

.row-group{
  grid-template-rows: 1fr 1fr;
  border-bottom: 1px solid #000;
  position:relative;
  column-gap:0;
  row-gap:0;
}

.row-group .cell{
  border-right: 1px solid #000;
  padding: 10px 12px;
  font-size: 15px;
  color:#000;
  background:#fff;

  display:flex;
  flex-direction:column;
  align-items:stretch;
  justify-content:center;

  min-height: var(--h-unit);
}

.row-group .cell:last-of-type{
  border-right: none;
}

.row-group .span2{
  grid-row: 1 / span 2;
  min-height: calc(var(--h-unit) * 2);
}

.cell.split-top{
  border-top: 1px solid #000;
}

/* 右外側ボタン */
.row-tools,
.row-del{
  position:absolute;
  top:50%;
  transform:translateY(-50%);
  width:34px;
  height:34px;
  border:1px solid #000;
  border-radius:8px;
  background:#fff;
  color:#000;
  cursor:point
