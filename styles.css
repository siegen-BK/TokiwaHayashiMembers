:root{
  /* ===== 黒/白のみ ===== */
  --ink:#000;        /* 文字色 */
  --grid:#000;       /* 罫線色 */
  --bg:#fff;         /* 背景 */

  /* ===== 列幅（ヘッダ/行で共通） ===== */
  --col-section: 1.6fr;  /* 区間・場所 */
  --col-part:    0.92fr; /* 大胴〜笛 */
  --col-notes:   1.4fr;  /* 備考 */

  /* ===== 行高 ===== */
  --h-unit: 36px;                      /* 1段 */
  --header-h: calc(var(--h-unit) / 2); /* 先頭行は半分 */

  /* ===== 固定（sticky）用：JSが代入 ===== */
  --sticky-top-toolbar:   0px;  /* タブ直下にツールバー */
  --sticky-top-tablehead: 0px;  /* ツールバー直下に先頭行 */
  --toolbar-h: 44px;            /* ツールバー実高（JSで上書き） */
}

*{ box-sizing:border-box; }

body{
  font-family: system-ui, -apple-system, "Segoe UI", Roboto, Helvetica, Arial;
  margin:0;
  color:var(--ink);
  background:var(--bg);
  width:100%;
  overflow-x:hidden; /* 横スクロール防止 */
}

/* =========================================================
   固定帯 1: タブ（アプリヘッダ）最上段に固定
   ========================================================= */
.app-header{
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  width: 100%;
  z-index: 100;
  background:#fff;
  border-bottom: 1px solid #000;
  padding: 12px 16px;
}

.tabs{
  display:flex;
  gap:8px;
  align-items:center;
  margin-top:8px;
  flex-wrap:wrap;
}

.tab{
  padding:6px 10px;
  border:1px solid #000;
  border-radius:8px;
  text-decoration:none;
  color:#000;
  background:#fff;
}

.tab.active{
  background:#000;
  color:#fff;
  border-color:#000;
}

.print{ margin-left:auto; }

/* 本文コンテナ */
main{
  padding:0;
  margin:0;
  max-width:none;
}

/* =========================================================
   固定帯 2: タイトル＆書式＆追加（タブ直下に固定）
   - 左上に [左 中 右 +追加]
   - 中央にタイトル
   ========================================================= */
.section-toolbar{
  position: fixed;
  top: var(--sticky-top-toolbar);
  left: 0;
  right: 0;
  width: 100%;
  z-index: 90;
  background:#fff;
  border-bottom: none;     /* 二重線を作らない */
  min-height:44px;
}

.toolbar-left{
  position:absolute;
  left:0;
  top:50%;
  transform:translateY(-50%);
  display:flex;
  gap:8px;
  align-items:center;
}

.align-inline button,
.btn-add{
  padding:6px 10px;
  border:1px solid #000;
  border-radius:8px;
  background:#fff;
  color:#000;
  cursor:pointer;
}

.align-inline button:hover,
.btn-add:hover{
  background:#fff; /* 黒白のみ（変化させない） */
}

.sheet-title{
  margin:8px 0;
  text-align:center;
  font-size:28px;
  font-weight:700;
  color:#000;
}

/* =========================================================
   表（Excel風：外枠＋格子）
   ========================================================= */

/* 列定義（先頭行/行で共通） */
.first-row-table,
.row-group{
  display:grid;
  grid-template-columns:
    var(--col-section)
    var(--col-part) var(--col-part) var(--col-part)
    var(--col-part) var(--col-part)
    var(--col-notes);
}

/* =========================================================
   固定帯 3: 先頭行（表ヘッダ）ツールバー直下に固定
   - 上枠線は純黒1px
   ========================================================= */
.first-row-table{
  border-top: 1px solid #000;
  border-left: 1px solid #000;
  border-right: 1px solid #000;
  border-bottom: none;
  margin:0;
  column-gap:0;
  row-gap:0;

  position: fixed;
  top: var(--sticky-top-tablehead);
  left: 0;
  right: 0;
  width: 100%;
  z-index: 80;
  background:#fff;
}

/* 先頭行セル */
.first-row-table .cell{
  border-bottom: 1px solid #000;
  padding: 0 12px;
  min-height: var(--header-h);
  display:flex;
  align-items:center;
  justify-content:center;
  text-align:center;
  font-size:15px;
  color:#000;
  background:#fff;
  white-space:nowrap;
}

/* ヘッダの縦罫線：最後以外 */
.first-row-table .cell:not(:last-child){
  border-right: 1px solid #000;
}

/* =========================================================
   データ行（スクロールで動くのはここだけ）
   ========================================================= */
.rows{
  position:relative;
  z-index:1;
  border-left: 1px solid #000;
  border-right: 1px solid #000;
  margin-top:0;
}

.row-group{
  grid-template-rows: 1fr 1fr;
  border-bottom: 1px solid #000;
  position:relative;
  column-gap:0;
  row-gap:0;
}

.row-group .cell{
  border-right: 1px solid #000;
  padding: 10px 12px;
  font-size: 15px;
  color:#000;
  background:#fff;

  display:flex;
  flex-direction:column;
  align-items:stretch;
  justify-content:center;

  min-height: var(--h-unit);
}

/* 右端セル（備考）だけ右線なし（外枠に任せる） */
.row-group .cell:last-of-type{
  border-right: none;
}

/* 2段ぶち抜き */
.row-group .span2{
  grid-row: 1 / span 2;
  min-height: calc(var(--h-unit) * 2);
}

/* 鉦・笛の下段だけ仕切り線 */
.cell.split-top{
  border-top: 1px solid #000;
}

/* =========================================================
   右外側：ツール／削除（行の垂直中央）
   - 固定帯より下層（z-index低め）
   ========================================================= */
.row-tools,
.row-del{
  position:absolute;
  top:50%;
  transform:translateY(-50%);
  width:34px;
  height:34px;
  border:1px solid #000;
  border-radius:8px;
  background:#fff;
  color:#000;
  cursor:pointer;
  display:grid;
  place-items:center;
  font-size:16px;
  line-height:1;
  z-index:5; /* 固定帯(z=80/90/100)に確実に隠れる */
}
.row-tools{ right:-44px; }
.row-del  { right:-84px; }

/* =========================================================
   行間境界スワップ（⇅）
   ========================================================= */
.swap-slot{
  position:relative;
  height:0;
}
.swap-slot .row-swap{
  position:absolute;
  left:-44px;
  top:-17px; /* 34px/2 */
  width:34px;
  height:34px;
  border:1px solid #000;
  border-radius:8px;
  background:#fff;
  color:#000;
  cursor:pointer;
  display:grid;
  place-items:center;
  font-size:16px;
  line-height:1;
  z-index:5; /* 固定帯に隠れる */
}

/* =========================================================
   ★重要：固定帯の“左右ガター含む”白マスク
   ========================================================= */
body::before{
  content:'';
  position:fixed;
  top: var(--sticky-top-toolbar);
  left:0;
  right:0;
  height: var(--toolbar-h);
  background:#fff;
  z-index:89;
  pointer-events:none;
}

body::after{
  content:'';
  position:fixed;
  top: var(--sticky-top-tablehead);
  left:0;
  right:0;
  height: calc(var(--header-h) + 2px);
  background:#fff;
  z-index:79;
  pointer-events:none;
}

/* =========================================================
   モバイル：ボタンを内側へ
   ========================================================= */
@media (max-width: 520px){
  .row-tools{ right:6px; }
  .row-del  { right:46px; }
  .swap-slot .row-swap{ left:6px; }
}

/* =========================================================
   メンバー表（黒/白）
   ========================================================= */
.members-table{
  display:grid;
  grid-template-columns: 2.2fr 2.2fr 1fr 1fr;
  border:1px solid #000;
  background:#fff;
}
.members-table .mcell{
  border-right:1px solid #000;
  border-bottom:1px solid #000;
  padding:8px 10px;
  min-height:34px;
  display:flex;
  align-items:center;
  color:#000;
  background:#fff;
}
.members-table .mcell:nth-child(4n){
  border-right:none;
}
.members-table .mcell.head{
  font-weight:700;
  justify-content:center;
}

/* =========================================================
   印刷：固定解除
   ========================================================= */
@media print{
  .app-header,
  .section-toolbar,
  .first-row-table{
    position: static;
  }
  body::before,
  body::after{
    display:none;
  }
  main{
    max-width:none;
    margin:0;
    padding:0 18mm;
  }
}
